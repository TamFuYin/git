# The 3rd Universal Cup. Stage 1: St. Petersburg

前言：由于胡乱鼓捣 git，把 The 3rd Universal Cup. Stage 2: Zielona Góra.md 给删掉了，沉痛悼念

## A. Element-Wise Comparison

看到这种神秘的判断条件和神秘的数据范围首先想到 bitset。然后用一个 baka's trick 维护即可。

## B. Schoolgirls

神秘几何题，不想做。

## C. Cherry Picking

从大到小插入元素，维护连续段长度。用一个 ODT 状物维护即可

## D. Dwarfs' Bedtime

思路：每隔 $25$ 次问一次，那么在第一次碰到这个点之后可以确定在一个长为 $25$ 的区间内，第二次快到这个点的时候挨着问即可。然后加一点随机化大概就能过了（$25±2$

## E. Fake Coin and Lying Scales

最抽象，或许读一些信息论会有益

假设我们进行了 $l$ 次称重操作，其中有 $v$ 次谎言（我们不知道谎言的分布），我们能得到什么信息？

我们本能得到 $3^l$ 的信息（左边重、右边重、一样重）。但是如果两种假币分布，在这 $l$ 次操作中，如果存在一种谎言分布，使其得到的「观测序列」完全相同，那么我们不能把这两种情况区分。

我们设 $p(l,v)$ 表示当假币分布固定时，对于所有谎言的可能性，其产生的所有观测序列的数量。可以看作谎言对信息的影响。

满足
$$
p(l,v)=2p(l-1,v-1)+p(l-1,v)
$$

意思是：如果这一次不说谎，那么本该是多少就是多少，否则会多两种。

那么答案即为信息的总量，即
$$
f(n,k)=\frac{(3k+1)3^n}{p(n,k)}
$$

身为 CNOI 选手，你大概一眼就能看出 $p(n,k)=\sum_{j=0}^k\binom nj2^j$。

这道题只需要求出来答案的量级，所以取 $p(n,k)\approx \binom nk2^k$ 即可。math.h 里面有一个 lgamma 的函数，顾名思义就是 $\ln \Gamma(n)$。用这个算阶乘就可以了。

特别地，如果 $k$ 比较大，那么最大那一项不在 $k$，而是 $(2n-1)/3$ 左右。